<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>AlphaFoxXP</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="cssescola.css">
    <link href="https://cdn.jsdelivr.net/npm/remixicon/fonts/remixicon.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-storage-compat.js"></script>
</head>

<body>
    <!-- Particles Background -->
    <div id="particles-js"></div>
    
    <!-- Loading Screen -->
    <div id="loading-screen">
        <div class="loading-content">
            <div class="loading-logo">
                <img src="https://i.postimg.cc/brfXwKJR/DALL-E-2024-11-16-14-19-55-A-modern-and-stylish-3-D-logo-with-the-name-Alpha-Fox-XP-in-bold-sleek.webp" alt="Logo" />
            </div>
            <div class="loading-spinner"></div>
            <div class="loading-text">AlphaFoxXP</div>
        </div>
    </div>

    <!-- Carrinho Avan√ßado -->
    <div id="carrinho-panel" class="carrinho-panel">
        <div class="carrinho-header">
            <h2><i class="ri-shopping-cart-line"></i> Seu Carrinho</h2>
            <button onclick="fecharCarrinho()" class="close-btn">
                <i class="ri-close-line"></i>
            </button>
        </div>
        <div class="carrinho-content">
            <ul id="lista-carrinho" class="lista-carrinho"></ul>
            <div class="carrinho-footer">
                <div class="total-section">
                    <p id="total-carrinho" class="total-carrinho">Total: R$ 0,00</p>
                </div>
                <button onclick="window.location.href='https://codepen.io/Escola-Garden/full/NPqBMgM'" class="btn-pagar">
                    <i class="ri-secure-payment-line"></i> Finalizar Compra
                </button>
                <button onclick="limparCarrinho()" class="btn-limpar">
                    <i class="ri-delete-bin-line"></i> Limpar Carrinho
                </button>
            </div>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div id="toast-container" class="toast-container"></div>

    <header class="header">
        <div class="header-content">
            <div class="logo">
                <div class="logo-container">
                    <img src="https://i.postimg.cc/brfXwKJR/DALL-E-2024-11-16-14-19-55-A-modern-and-stylish-3-D-logo-with-the-name-Alpha-Fox-XP-in-bold-sleek.webp" alt="Logo" />
                </div>
                <span class="title">AlphaFoxXP</span>
            </div>
            
            <div class="actions">
                <button class="action-btn" id="search-icon" title="Buscar">
                    <i class="ri-search-line"></i>
                </button>
                <button class="action-btn" onclick="window.location.href='teladelogin.html'" title="Login">
                    <i class="ri-user-line"></i>
                </button>
                <button class="action-btn" id="admin-access" title="Acesso Admin">
                    <i class="ri-admin-line"></i>
                </button>
                <button class="action-btn cart-btn" title="Carrinho" onclick="abrirCarrinho()">
                    <i class="ri-shopping-cart-line"></i>
                    <span id="cart-count" class="cart-count">0</span>
                </button>
                <button class="action-btn menu-btn" id="menu-toggle" title="Menu">
                    <i class="ri-menu-3-line"></i>
                </button>
            </div>
        </div>

        <nav id="menu-items" class="nav-menu">
            <button onclick="window.location.href='index.html'">
                <i class="ri-home-line"></i> In√≠cio
            </button>
            <button onclick="window.location.href='edi√ßao.html'">
                <i class="ri-settings-line"></i> Configura√ß√£o
            </button>
            <button onclick="window.location.href='comunidade.html'">
                <i class="ri-group-line"></i> Comunidade & Blog
            </button>
            <button onclick="window.location.href='planos.html'">
                <i class="ri-vip-crown-line"></i> Planos
            </button>
            <button onclick="window.location.href='quemsomos.html'">
                <i class="ri-information-line"></i> Sobre
            </button>
            <button onclick="window.location.href='suporte.html'">
                <i class="ri-customer-service-line"></i> Suporte
            </button>
        </nav>

        <div id="search-box" class="search-box">
            <div class="search-container">
                <i class="ri-search-line"></i>
                <input type="text" id="search-input" placeholder="Buscar produtos...">
            </div>
        </div>
    </header>

    <div class="dividerPremium">
        <div class="title-container">
            <div class="title">Comprar Contas</div>
            <div class="subtitle">Produtos premium com qualidade garantida</div>
        </div>
    </div>

    <section class="categorias">
        <div class="categorias-container">
            <span class="categoria-btn active" data-cat="todos">
                <i class="ri-apps-line"></i> Todos
            </span>
            <span class="categoria-btn" data-cat="Games">
                <i class="ri-gamepad-line"></i> Games
            </span>
            <span class="categoria-btn" data-cat="Gift Cards">
                <i class="ri-gift-line"></i> Gift Cards
            </span>
            <span class="categoria-btn" data-cat="Contas">
                <i class="ri-user-settings-line"></i> Contas
            </span>
            <span class="categoria-btn" data-cat="Ofertas">
                <i class="ri-fire-line"></i> Ofertas
            </span>
            <span class="categoria-btn" data-cat="Novidades">
                <i class="ri-star-line"></i> Novidades
            </span>
        </div>
    </section>

    <main class="main-content">
        <div class="vitrine-grid" id="product-list"></div>
    </main>

    <!-- Painel Admin Modal -->
    <div id="admin-panel-bg" class="admin-modal-bg" role="dialog" aria-modal="true" aria-labelledby="admin-panel-title">
        <div id="admin-panel" class="admin-panel">
            <header class="admin-header">
                <h2 id="admin-panel-title">
                    <i class="ri-admin-line"></i> Painel Admin
                </h2>
                <button id="admin-close-btn" class="close-btn" aria-label="Fechar painel admin">
                    <i class="ri-close-line"></i>
                </button>
            </header>
            
            <nav class="admin-nav">
                <button id="btn-controle-estoque" class="admin-nav-btn">
                    <i class="ri-box-3-line"></i> Controle de Estoque
                </button>
                <button id="btn-controle-usuarios" class="admin-nav-btn">
                    <i class="ri-user-settings-line"></i> Controle de Usu√°rios
                </button>
                <button onclick="exportarDadosFirebase()" class="admin-nav-btn">
                    <i class="ri-download-line"></i> Exportar Dados Firebase
                </button>
            </nav>

            <!-- Controle de Estoque -->
            <section id="controle-estoque" class="admin-section">
                <form id="novo-produto-form" class="produto-form" aria-label="Adicionar novo produto">
                    <div class="form-group">
                        <label for="input-nome">T√≠tulo do Produto</label>
                        <input type="text" id="input-nome" placeholder="Digite o t√≠tulo do an√∫ncio" required autocomplete="off" />
                    </div>
                    <div class="form-group">
                        <label for="input-descricao">Descri√ß√£o</label>
                        <textarea id="input-descricao" placeholder="Descri√ß√£o detalhada do produto" required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="input-preco">Pre√ßo (R$)</label>
                        <input type="number" id="input-preco" placeholder="0.00" required step="0.01" min="0" />
                    </div>
                    <div class="form-group">
                        <label for="input-imagem">URL da Imagem</label>
                        <input type="url" id="input-imagem" placeholder="https://exemplo.com/imagem.jpg" required autocomplete="off" />
                    </div>
                    <button type="submit" class="btn-submit">
                        <i class="ri-add-line"></i> <span id="btn-submit-text">Publicar Novo An√∫ncio</span>
                    </button>
                    <button type="button" id="btn-cancelar-edicao" class="btn-cancel" style="display: none;">
                        <i class="ri-close-line"></i> Cancelar Edi√ß√£o
                    </button>
                </form>

                <div class="estoque-table-container">
                    <table class="estoque-table" aria-label="Lista de an√∫ncios ativos">
                        <thead>
                            <tr>
                                <th>Imagem</th>
                                <th>T√≠tulo</th>
                                <th>Descri√ß√£o</th>
                                <th>Pre√ßo</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody id="estoque-tbody">
                            <!-- Produtos listados aqui -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Controle de Usu√°rios -->
            <section id="controle-usuarios" class="admin-section">
                <div class="coming-soon">
                    <i class="ri-tools-line"></i>
                    <h3>Funcionalidade em Desenvolvimento</h3>
                    <p>O controle de usu√°rios estar√° dispon√≠vel em breve.</p>
                </div>
            </section>
        </div>
    </div>

    <!-- Firebase Config -->
    <script>
        // Configura√ß√£o Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyDOMJYymvjApHshn7TWe83KEpM-2eoC09A",
            authDomain: "escola-5db5c.firebaseapp.com",
            projectId: "escola-5db5c",
        };
        
        // Inicializar Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();
        const storage = firebase.storage();
    </script>

    <script>
        // ========================================
        // SISTEMA FIREBASE - ALPHAFOX XP
        // ========================================

        // Vari√°veis Globais
        let produtos = [];
        let carrinho = [];
        let filtroCategoria = 'todos';
        let produtoEditandoId = null;

        // Refer√™ncias DOM
        const productList = document.getElementById('product-list');
        const categorias = document.querySelectorAll('.categoria-btn');
        const searchInput = document.getElementById('search-input');
        const estoqueTbody = document.getElementById('estoque-tbody');
        const formNovoProduto = document.getElementById('novo-produto-form');
        const inputNome = document.getElementById('input-nome');
        const inputDescricao = document.getElementById('input-descricao');
        const inputPreco = document.getElementById('input-preco');
        const inputImagem = document.getElementById('input-imagem');
        const btnSubmitText = document.getElementById('btn-submit-text');
        const btnCancelarEdicao = document.getElementById('btn-cancelar-edicao');

        // ========================================
        // FIREBASE - CARREGAR PRODUTOS
        // ========================================
        function carregarProdutosFirebase() {
            db.collection('anuncios').onSnapshot((snapshot) => {
                produtos = [];
                snapshot.forEach((doc) => {
                    produtos.push({ id: doc.id, ...doc.data() });
                });
                renderVitrine();
                carregarTabelaEstoque();
            }, (error) => {
                console.error('Erro ao carregar produtos:', error);
                mostrarToast('‚ùå Erro ao carregar produtos do Firebase', 'error');
            });
        }

        // ========================================
        // FIREBASE - ADICIONAR PRODUTO
        // ========================================
        async function adicionarProdutoFirebase(produto) {
            try {
                await db.collection('anuncios').add({
                    nome: produto.nome,
                    descricao: produto.descricao,
                    preco: produto.preco,
                    imagem: produto.imagem,
                    categoria: produto.categoria,
                    dataCriacao: firebase.firestore.FieldValue.serverTimestamp()
                });
                mostrarToast('‚úÖ Produto adicionado com sucesso!', 'success');
                limparCamposProduto();
            } catch (error) {
                console.error('Erro ao adicionar produto:', error);
                mostrarToast('‚ùå Erro ao adicionar produto', 'error');
            }
        }

        // ========================================
        // FIREBASE - ATUALIZAR PRODUTO
        // ========================================
        async function atualizarProdutoFirebase(id, produto) {
            try {
                await db.collection('anuncios').doc(id).update({
                    nome: produto.nome,
                    descricao: produto.descricao,
                    preco: produto.preco,
                    imagem: produto.imagem,
                    categoria: produto.categoria,
                    dataAtualizacao: firebase.firestore.FieldValue.serverTimestamp()
                });
                mostrarToast('‚úÖ Produto atualizado com sucesso!', 'success');
                limparCamposProduto();
            } catch (error) {
                console.error('Erro ao atualizar produto:', error);
                mostrarToast('‚ùå Erro ao atualizar produto', 'error');
            }
        }

        // ========================================
        // FIREBASE - REMOVER PRODUTO
        // ========================================
        async function removerProdutoFirebase(id) {
            try {
                await db.collection('anuncios').doc(id).delete();
                mostrarToast('üóëÔ∏è Produto removido com sucesso!', 'success');
            } catch (error) {
                console.error('Erro ao remover produto:', error);
                mostrarToast('‚ùå Erro ao remover produto', 'error');
            }
        }

        // ========================================
        // FIREBASE - CARRINHO (SALVAR)
        // ========================================
        async function salvarCarrinhoFirebase() {
            const userId = obterUserIdUnico();
            try {
                await db.collection('carrinhos').doc(userId).set({
                    itens: carrinho,
                    ultimaAtualizacao: firebase.firestore.FieldValue.serverTimestamp()
                });
                atualizarContadorCarrinho();
            } catch (error) {
                console.error('Erro ao salvar carrinho:', error);
            }
        }

        // ========================================
        // FIREBASE - CARRINHO (CARREGAR)
        // ========================================
        async function carregarCarrinhoFirebase() {
            const userId = obterUserIdUnico();
            try {
                const doc = await db.collection('carrinhos').doc(userId).get();
                if (doc.exists) {
                    carrinho = doc.data().itens || [];
                } else {
                    carrinho = [];
                }
                atualizarContadorCarrinho();
                renderCarrinho();
            } catch (error) {
                console.error('Erro ao carregar carrinho:', error);
                carrinho = [];
            }
        }

        // ========================================
        // GERAR ID √öNICO POR USU√ÅRIO
        // ========================================
        function obterUserIdUnico() {
            let userId = localStorage.getItem('alphaFoxUserId');
            if (!userId) {
                userId = 'user_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
                localStorage.setItem('alphaFoxUserId', userId);
            }
            return userId;
        }

        // ========================================
        // RENDER VITRINE DE PRODUTOS
        // ========================================
        function renderVitrine() {
            productList.innerHTML = '';
            let listaFiltrada = filtroCategoria === 'todos' 
                ? produtos 
                : produtos.filter(p => p.categoria === filtroCategoria);
            
            const termoBusca = searchInput.value.toLowerCase();
            if (termoBusca) {
                listaFiltrada = listaFiltrada.filter(p => 
                    p.nome.toLowerCase().includes(termoBusca) || 
                    (p.descricao && p.descricao.toLowerCase().includes(termoBusca))
                );
            }
            
            if (listaFiltrada.length === 0) {
                productList.innerHTML = `
                    <div class="empty-state">
                        <i class="ri-inbox-line"></i>
                        <h3>Nenhum produto encontrado</h3>
                        <p>Tente ajustar os filtros ou buscar por outros termos</p>
                    </div>
                `;
                return;
            }

            listaFiltrada.forEach(p => {
                const div = document.createElement('div');
                div.className = 'product-card';
                div.innerHTML = `
                    <div class="card-image">
                        <img src="${p.imagem}" alt="${p.nome}" loading="lazy" onerror="this.src='https://via.placeholder.com/300x200?text=Sem+Imagem'">
                        <div class="card-overlay">
                            <button class="quick-view-btn" onclick='adicionarAoCarrinho(${JSON.stringify(p).replace(/'/g, "'")})'>
                                <i class="ri-shopping-cart-line"></i>
                            </button>
                        </div>
                    </div>
                    <div class="card-content">
                        <h3 class="card-title">${p.nome}</h3>
                        <p class="card-description">${p.descricao ? p.descricao.substring(0, 60) + '...' : ''}</p>
                        <div class="card-footer">
                            <span class="card-price">R$ ${Number(p.preco).toFixed(2)}</span>
                            <button class="add-to-cart-btn" onclick='adicionarAoCarrinho(${JSON.stringify(p).replace(/'/g, "'")})'>
                                <i class="ri-add-line"></i> Adicionar
                            </button>
                        </div>
                    </div>
                `;
                productList.appendChild(div);
            });
        }

        // ========================================
        // BUSCA DIN√ÇMICA
        // ========================================
        searchInput.addEventListener('input', renderVitrine);

        // ========================================
        // FILTROS DE CATEGORIA
        // ========================================
        categorias.forEach(cat => {
            cat.addEventListener('click', () => {
                categorias.forEach(c => c.classList.remove('active'));
                cat.classList.add('active');
                filtroCategoria = cat.dataset.cat;
                renderVitrine();
            });
        });

        // ========================================
        // CARRINHO - ADICIONAR PRODUTO
        // ========================================
        function adicionarAoCarrinho(produto) {
            const existente = carrinho.find(p => p.id === produto.id);
            if (existente) {
                existente.quantidade += 1;
            } else {
                carrinho.push({ ...produto, quantidade: 1 });
            }
            salvarCarrinhoFirebase();
            renderCarrinho();
            mostrarToast(`‚úÖ <strong>${produto.nome}</strong> adicionado ao carrinho.`);
        }

        // ========================================
        // CARRINHO - REMOVER PRODUTO
        // ========================================
        function removerDoCarrinho(index) {
            carrinho.splice(index, 1);
            salvarCarrinhoFirebase();
            renderCarrinho();
        }

        // ========================================
        // CARRINHO - ALTERAR QUANTIDADE
        // ========================================
        function alterarQuantidade(index, delta) {
            carrinho[index].quantidade += delta;
            if (carrinho[index].quantidade <= 0) {
                removerDoCarrinho(index);
            } else {
                salvarCarrinhoFirebase();
                renderCarrinho();
            }
        }

        // ========================================
        // CARRINHO - LIMPAR
        // ========================================
        function limparCarrinho() {
            if (confirm('Tem certeza que deseja limpar o carrinho?')) {
                carrinho = [];
                salvarCarrinhoFirebase();
                renderCarrinho();
                mostrarToast('üßπ Carrinho limpo com sucesso.');
            }
        }

        // ========================================
        // CARRINHO - CALCULAR TOTAL
        // ========================================
        function calcularTotal() {
            return carrinho.reduce((soma, item) => soma + (Number(item.preco) * item.quantidade), 0);
        }

        // ========================================
        // CARRINHO - RENDER
        // ========================================
        function renderCarrinho() {
            const lista = document.getElementById('lista-carrinho');
            const totalEl = document.getElementById('total-carrinho');
            
            lista.innerHTML = '';
            
            if (carrinho.length === 0) {
                lista.innerHTML = `
                    <li class="carrinho-empty">
                        <i class="ri-shopping-cart-line"></i>
                        <p>Seu carrinho est√° vazio</p>
                    </li>
                `;
                totalEl.textContent = 'Total: R$ 0,00';
                return;
            }

            carrinho.forEach((item, index) => {
                const li = document.createElement('li');
                li.className = 'carrinho-item';
                li.innerHTML = `
                    <div class="item-image">
                        <img src="${item.imagem}" alt="${item.nome}" onerror="this.src='https://via.placeholder.com/80?text=Sem+Imagem'">
                    </div>
                    <div class="item-details">
                        <h4>${item.nome}</h4>
                        <p class="item-price">R$ ${Number(item.preco).toFixed(2)}</p>
                    </div>
                    <div class="item-controls">
                        <div class="quantity-controls">
                            <button onclick="alterarQuantidade(${index}, -1)" class="qty-btn">
                                <i class="ri-subtract-line"></i>
                            </button>
                            <span class="quantity">${item.quantidade}</span>
                            <button onclick="alterarQuantidade(${index}, 1)" class="qty-btn">
                                <i class="ri-add-line"></i>
                            </button>
                        </div>
                        <button onclick="removerDoCarrinho(${index})" class="remove-btn" title="Remover item">
                            <i class="ri-delete-bin-line"></i>
                        </button>
                    </div>
                `;
                lista.appendChild(li);
            });

            totalEl.textContent = 'Total: R$ ' + calcularTotal().toFixed(2);
        }

        // ========================================
        // CARRINHO - ABRIR/FECHAR
        // ========================================
        function abrirCarrinho() {
            renderCarrinho();
            document.getElementById('carrinho-panel').classList.add('active');
        }

        function fecharCarrinho() {
            document.getElementById('carrinho-panel').classList.remove('active');
        }

        // ========================================
        // ATUALIZAR CONTADOR CARRINHO
        // ========================================
        function atualizarContadorCarrinho() {
            const contador = document.getElementById('cart-count');
            const total = carrinho.reduce((sum, item) => sum + item.quantidade, 0);
            contador.textContent = total;
            contador.style.display = total > 0 ? 'flex' : 'none';
        }

        // ========================================
        // TOAST NOTIFICATIONS
        // ========================================
        function mostrarToast(mensagem, tipo = 'success', tempo = 3000) {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');
            toast.className = `toast toast-${tipo}`;
            toast.innerHTML = `
                <div class="toast-content">
                    <span class="toast-message">${mensagem}</span>
                    <button class="toast-close" onclick="this.parentElement.parentElement.remove()">
                        <i class="ri-close-line"></i>
                    </button>
                </div>
            `;
            container.appendChild(toast);

            setTimeout(() => toast.classList.add('show'), 100);
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => {
                    if (toast.parentNode) container.removeChild(toast);
                }, 300);
            }, tempo);
        }

        // ========================================
        // ADMIN - CARREGAR TABELA ESTOQUE
        // ========================================
        function carregarTabelaEstoque() {
            estoqueTbody.innerHTML = '';
            if (produtos.length === 0) {
                estoqueTbody.innerHTML = `
                    <tr>
                        <td colspan="5" style="text-align: center; padding: 2rem;">
                            <i class="ri-inbox-line" style="font-size: 3rem; color: #999;"></i>
                            <p>Nenhum produto cadastrado</p>
                        </td>
                    </tr>
                `;
                return;
            }

            produtos.forEach((produto) => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>
                        <img src="${produto.imagem}" alt="${produto.nome}" class="table-image" onerror="this.src='https://via.placeholder.com/60?text=Sem+Imagem'">
                    </td>
                    <td class="table-title">${produto.nome}</td>
                    <td class="table-description">${produto.descricao}</td>
                    <td class="table-price">R$ ${Number(produto.preco).toFixed(2)}</td>
                    <td class="table-actions">
                        <button onclick="editarProduto('${produto.id}')" class="edit-btn" title="Editar">
                            <i class="ri-edit-line"></i>
                        </button>
                        <button onclick="removerProduto('${produto.id}')" class="delete-btn" title="Remover">
                            <i class="ri-delete-bin-line"></i>
                        </button>
                    </td>
                `;
                estoqueTbody.appendChild(tr);
            });
        }

        // ========================================
        // ADMIN - EDITAR PRODUTO
        // ========================================
        window.editarProduto = function(id) {
            const produto = produtos.find(p => p.id === id);
            if (!produto) return;

            inputNome.value = produto.nome;
            inputDescricao.value = produto.descricao;
            inputPreco.value = produto.preco;
            inputImagem.value = produto.imagem;
            
            produtoEditandoId = id;
            btnSubmitText.textContent = 'Atualizar Produto';
            btnCancelarEdicao.style.display = 'inline-block';
            
            window.scrollTo({ top: 0, behavior: 'smooth' });
        };

        // ========================================
        // ADMIN - REMOVER PRODUTO
        // ========================================
        window.removerProduto = function(id) {
            if (confirm('Deseja realmente remover este produto?')) {
                removerProdutoFirebase(id);
            }
        };

        // ========================================
        // ADMIN - LIMPAR CAMPOS
        // ========================================
        function limparCamposProduto() {
            inputNome.value = '';
            inputDescricao.value = '';
            inputPreco.value = '';
            inputImagem.value = '';
            produtoEditandoId = null;
            btnSubmitText.textContent = 'Publicar Novo An√∫ncio';
            btnCancelarEdicao.style.display = 'none';
        }

        // ========================================
        // ADMIN - CANCELAR EDI√á√ÉO
        // ========================================
        btnCancelarEdicao.addEventListener('click', limparCamposProduto);

        // ========================================
        // ADMIN - SUBMIT FORMUL√ÅRIO
        // ========================================
        formNovoProduto.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const nome = inputNome.value.trim();
            const descricao = inputDescricao.value.trim();
            const preco = parseFloat(inputPreco.value);
            const imagem = inputImagem.value.trim();
            if (!nome || !descricao || isNaN(preco) || preco < 0 || !imagem) {
                mostrarToast('‚ùå Preencha todos os campos corretamente.', 'error');
                return;
            }

            const novoProduto = {
                nome,
                descricao,
                preco,
                imagem,
                categoria: detectarCategoria(nome, descricao)
            };

            if (produtoEditandoId) {
                await atualizarProdutoFirebase(produtoEditandoId, novoProduto);
            } else {
                await adicionarProdutoFirebase(novoProduto);
            }
        });

        // ========================================
        // DETECTAR CATEGORIA AUTOMATICAMENTE
        // ========================================
        function detectarCategoria(nome, descricao) {
            const texto = (nome + ' ' + descricao).toLowerCase();
            if (texto.includes('game') || texto.includes('jogo')) return 'Games';
            if (texto.includes('gift card') || texto.includes('cart√£o')) return 'Gift Cards';
            if (texto.includes('conta')) return 'Contas';
            if (texto.includes('oferta') || texto.includes('promo√ß√£o')) return 'Ofertas';
            if (texto.includes('novo') || texto.includes('lan√ßamento')) return 'Novidades';
            return 'Outros';
        }

        // ========================================
        // EXPORTAR DADOS DO FIREBASE
        // ========================================
        async function exportarDadosFirebase() {
            try {
                mostrarToast('üì• Exportando dados...', 'info');
                
                const anunciosSnapshot = await db.collection('anuncios').get();
                const carrinhosSnapshot = await db.collection('carrinhos').get();
                
                const anuncios = [];
                anunciosSnapshot.forEach(doc => {
                    anuncios.push({ id: doc.id, ...doc.data() });
                });
                
                const carrinhos = [];
                carrinhosSnapshot.forEach(doc => {
                    carrinhos.push({ id: doc.id, ...doc.data() });
                });
                
                const dados = {
                    anuncios,
                    carrinhos,
                    dataExportacao: new Date().toISOString()
                };
                
                const conteudo = JSON.stringify(dados, null, 2);
                const blob = new Blob([conteudo], { type: "application/json" });
                const url = URL.createObjectURL(blob);
                
                const a = document.createElement("a");
                a.href = url;
                a.download = `alphafoxxp-backup-${Date.now()}.json`;
                a.click();
                URL.revokeObjectURL(url);
                
                mostrarToast('‚úÖ Dados exportados com sucesso!', 'success');
            } catch (error) {
                console.error('Erro ao exportar dados:', error);
                mostrarToast('‚ùå Erro ao exportar dados', 'error');
            }
        }

        // ========================================
        // PAINEL ADMIN - CONTROLES
        // ========================================
        const adminPanelBg = document.getElementById('admin-panel-bg');
        const adminCloseBtn = document.getElementById('admin-close-btn');
        const adminAccess = document.getElementById('admin-access');
        const btnEstoque = document.getElementById('btn-controle-estoque');
        const btnUsuarios = document.getElementById('btn-controle-usuarios');
        const controleEstoque = document.getElementById('controle-estoque');
        const controleUsuarios = document.getElementById('controle-usuarios');

        adminAccess.addEventListener('click', () => {
            const senha = prompt('Acesso Restrito - Insira o c√≥digo de seguran√ßa:');
            if (senha === '454') {
                adminPanelBg.style.display = 'flex';
                mostrarTelaAdmin('estoque');
            } else if (senha) {
                mostrarToast('‚ùå C√≥digo inv√°lido!', 'error');
            }
        });

        adminCloseBtn.addEventListener('click', () => {
            adminPanelBg.style.display = 'none';
            limparCamposProduto();
        });

        adminPanelBg.addEventListener('click', (e) => {
            if (e.target === adminPanelBg) {
                adminPanelBg.style.display = 'none';
                limparCamposProduto();
            }
        });

        btnEstoque.addEventListener('click', () => mostrarTelaAdmin('estoque'));
        btnUsuarios.addEventListener('click', () => {
            window.location.href = 'usuariostyr.html';
        });

        function mostrarTelaAdmin(tela) {
            if (tela === 'estoque') {
                controleEstoque.style.display = 'block';
                controleUsuarios.style.display = 'none';
                btnEstoque.classList.add('active');
                btnUsuarios.classList.remove('active');
            } else if (tela === 'usuarios') {
                controleEstoque.style.display = 'none';
                controleUsuarios.style.display = 'block';
                btnEstoque.classList.remove('active');
                btnUsuarios.classList.add('active');
            }
        }

        // ========================================
        // BUSCA - MOSTRAR/ESCONDER
        // ========================================
        const searchIcon = document.getElementById('search-icon');
        const searchBox = document.getElementById('search-box');
        
        searchIcon.addEventListener('click', () => {
            if (searchBox.classList.contains('active')) {
                searchBox.classList.remove('active');
                searchInput.value = '';
                renderVitrine();
            } else {
                searchBox.classList.add('active');
                searchInput.focus();
            }
        });

        // ========================================
        // MENU TOGGLE
        // ========================================
        const menuToggle = document.getElementById('menu-toggle');
        const menuItems = document.getElementById('menu-items');
        
        menuToggle.addEventListener('click', () => {
            menuItems.classList.toggle('active');
        });

        // ========================================
        // PARTICLES.JS CONFIGURATION
        // ========================================
        particlesJS('particles-js', {
            particles: {
                number: { value: 80, density: { enable: true, value_area: 800 } },
                color: { value: "#ff5722" },
                shape: {
                    type: "circle",
                    stroke: { width: 0, color: "#000000" },
                    polygon: { nb_sides: 5 }
                },
                opacity: {
                    value: 0.5,
                    random: false,
                    anim: { enable: false, speed: 1, opacity_min: 0.1, sync: false }
                },
                size: {
                    value: 3,
                    random: true,
                    anim: { enable: false, speed: 40, size_min: 0.1, sync: false }
                },
                line_linked: {
                    enable: true,
                    distance: 150,
                    color: "#ff5722",
                    opacity: 0.4,
                    width: 1
                },
                move: {
                    enable: true,
                    speed: 6,
                    direction: "none",
                    random: false,
                    straight: false,
                    out_mode: "out",
                    bounce: false,
                    attract: { enable: false, rotateX: 600, rotateY: 1200 }
                }
            },
            interactivity: {
                detect_on: "canvas",
                events: {
                    onhover: { enable: true, mode: "repulse" },
                    onclick: { enable: true, mode: "push" },
                    resize: true
                },
                modes: {
                    grab: { distance: 400, line_linked: { opacity: 1 } },
                    bubble: { distance: 400, size: 40, duration: 2, opacity: 8, speed: 3 },
                    repulse: { distance: 200, duration: 0.4 },
                    push: { particles_nb: 4 },
                    remove: { particles_nb: 2 }
                }
            },
            retina_detect: true
        });

        // ========================================
        // LOADING SCREEN
        // ========================================
        window.addEventListener('load', function() {
            setTimeout(() => {
                const loadingScreen = document.getElementById('loading-screen');
                loadingScreen.style.opacity = '0';
                setTimeout(() => {
                    loadingScreen.style.display = 'none';
                }, 500);
            }, 1500);
        });

        // ========================================
        // INICIALIZA√á√ÉO DO SISTEMA
        // ========================================
        async function inicializarSistema() {
            try {
                // Carregar produtos do Firebase
                carregarProdutosFirebase();
                
                // Carregar carrinho do Firebase
                await carregarCarrinhoFirebase();
                
                console.log('‚úÖ Sistema AlphaFoxXP inicializado com Firebase!');
            } catch (error) {
                console.error('‚ùå Erro ao inicializar sistema:', error);
                mostrarToast('‚ö†Ô∏è Erro ao conectar com o Firebase', 'error');
            }
        }

        // Inicializar quando a p√°gina carregar
        inicializarSistema();

        // ========================================
        // FECHAR MENUS AO CLICAR FORA
        // ========================================
        document.addEventListener('click', (e) => {
            if (!e.target.closest('.header') && menuItems.classList.contains('active')) {
                menuItems.classList.remove('active');
            }
            
            if (!e.target.closest('#search-box') && !e.target.closest('#search-icon')) {
                if (searchBox.classList.contains('active') && searchInput.value === '') {
                    searchBox.classList.remove('active');
                }
            }
        });

        // ========================================
        // TECLA ESC PARA FECHAR MODAIS
        // ========================================
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                if (adminPanelBg.style.display === 'flex') {
                    adminPanelBg.style.display = 'none';
                    limparCamposProduto();
                }
                if (document.getElementById('carrinho-panel').classList.contains('active')) {
                    fecharCarrinho();
                }
                if (searchBox.classList.contains('active')) {
                    searchBox.classList.remove('active');
                    searchInput.value = '';
                    renderVitrine();
                }
            }
        });

        // ========================================
        // PREVENIR M√öLTIPLOS CLIQUES
        // ========================================
        let isSubmitting = false;
        formNovoProduto.addEventListener('submit', async (e) => {
            if (isSubmitting) {
                e.preventDefault();
                return;
            }
            isSubmitting = true;
            setTimeout(() => { isSubmitting = false; }, 2000);
        });
    </script>

    <!-- Footer -->
    <footer id="contato">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>AlphaFoxXP</h3>
                    <p>Sua plataforma premium para produtos digitais. Seguran√ßa, rapidez e confiabilidade em cada transa√ß√£o.</p>
                    <div class="social-links">
                        <a href="#" class="social-link"><i class="ri-instagram-line"></i></a>
                        <a href="#" class="social-link"><i class="ri-twitter-line"></i></a>
                        <a href="#" class="social-link"><i class="ri-discord-line"></i></a>
                        <a href="#" class="social-link"><i class="ri-youtube-line"></i></a>
                    </div>
                </div>
                <div class="footer-section">
                    <h3>Contato</h3>
                    <p><i class="ri-mail-line"></i> contato@alphafoxxp.com</p>
                    <p><i class="ri-phone-line"></i> (11) 99999-9999</p>
                    <p><i class="ri-map-pin-line"></i> S√£o Paulo, SP - Brasil</p>
                    <p><i class="ri-time-line"></i> Seg-Dom: 24h</p>
                </div>
                <div class="footer-section">
                    <h3>Links √öteis</h3>
                    <p><a href="index.html">In√≠cio</a></p>
                    <p><a href="produtos.html">Produtos</a></p>
                    <p><a href="planos.html">Planos</a></p>
                    <p><a href="comunidade.html"><i class="ri-group-line"></i> Comunidade & Blog</a></p>
                    <p><a href="suporte.html">Suporte</a></p>
                </div>
                <div class="footer-section">
                    <h3>Certifica√ß√µes</h3>
                    <p>‚úì SSL Certificado</p>
                    <p>‚úì PCI DSS Compliant</p>
                    <p>‚úì ISO 27001</p>
                    <p>‚úì LGPD Compliance</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>¬© 2024 AlphaFoxXP. Todos os direitos reservados. | Desenvolvido com ‚ù§Ô∏è para gamers</p>
            </div>
        </div>
    </footer>

</body>
</html>
